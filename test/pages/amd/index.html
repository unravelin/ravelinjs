<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ravelinjs amd test</title>
    <style>input { width: 100%; }</style>
    <link rel="stylesheet" href="../style.css" />
</head>
<body>
    <pre id="useragent"></pre>
    <div style="display:flex; flex-direction:row">
        <pre style="display:inline-block" id="cookies"><b>Cookies: </b></pre>
    </div>
    <div style="display:flex; flex-direction:row">
        <pre style="display:inline-block" id="deviceid"><b>DeviceId: </b></pre>
        <pre style="display:inline-block" id="sessionid"><b>SessionId: </b></pre>
    </div>

    <div id="container">
        <div class="row">
            <div class="block">
                RSA Public Key: <textarea id="rsa-key" rows="5">10001|BB2D2D2FD3812FEBECF8955843228A0E1952342583DFC02B8393475C414E16FDCBE8753BD63C164104785D8A67E344D495B5C0C622CE8D643F3191BC6BE0D3050F391F77E1D7E1B8F69DA34B308477E31F775CCC44158E33FD7DDD51AC87DD33AD80B9B1BF850CEC79A189F011C0689C36C0C91BF6DB9CD65BB7399710E32D9876C00DD44103E54A64A44BF427E1BA4F48DA7AF3D623DBCCF282ED8D4CCAE31B921A9BE92F9E8D7B5C50FBD89D828539CAE3E3493D4F6D7ADA19A876D9DF3801B5C3CFFA6A3C72A246150F307D789BAD6E2408DA5EF05EE805E11C133FFEDFA57CD1C35E49106ADDAC43C51995B9C318066C9ACB4042D8A534370D79F1BAD601</textarea>
                <br/>
                <button id="setRSAKey"/> Set </button>
            </div>

            <div class="block">
                Publishable Token: <input id="pub-token" type="text" value="">
                <br/><button id="setPublicAPIKey"> Set </button>
            </div>

            <div class="block">
                <span>CustomerId: </span>
                <div class="row">
                    <input id="customer-id" type="text">
                    <button id="setCustomerId"> Set </button>
                </div>
                <span>TempCustomerId: </span>
                <div class="row">
                    <input id="temp-customer-id" type="text">
                    <button id="setTempCustomerId"> Set </button>
                </div>
                <span>OrderId: </span>
                <div class="row">
                    <input id="order-id" type="text">
                    <button id="setOrderId"> Set </button>
                </div>
            </div>

            <div class="block column">
                <button id="trackFingerprint" style="width:100px;">Fingerprint</button>
                <button id="track" style="width:100px;">Track</button>
                <button id="trackPage" style="width:100px;">Track Page</button>
                <button id="trackLogin" style="width:100px;">Track Login</button>
                <button id="trackLogout" style="width:100px;">Track Logout</button>
            </div>
        </div>
    </div>
    <div class="column">
        <h2>Encryption</h2>
        <div class="block">
            Name on Card: <input type="text" id="name" />
            Card Number: <input type="text" id="number" />
            Month: <select id="month">
                <option selected value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
            </select><br/>
            Year: <input type="number" id="year" />

            <br/> <button id="encrypt" > Encrypt </button>
        </div>
        <h2>Output</h2>
        <pre id="encryption-output"></pre>
        <h2>Output Error</h2>
        <pre id="encryption-output-error"></pre>
    </div>

    <script src="../common.js"></script>
    <script src="require.js"></script>
    <script>
        require(['ravelin'], function(ravelin) {
            document.getElementById('encrypt').onclick = function() {
                var month = document.getElementById('month');
                output('encryption-output', function() {
                    return ravelin.encrypt({
                        nameOnCard: document.getElementById('name').value,
                        pan: document.getElementById('number').value,
                        month: month.options[month.selectedIndex].value,
                        year: document.getElementById('year').value,
                    });
                });
                return false;
            };

            var setRSAKey = function() { ravelin.setRSAKey(document.getElementById('rsa-key').value); };
            var setPublicAPIKey = function() { ravelin.setPublicAPIKey(document.getElementById('pub-token').value); };
            var setCustomerId = function() { ravelin.setCustomerId(document.getElementById('customer-id').value); };
            var setTempCustomerId = function() { ravelin.setTempCustomerId(document.getElementById('temp-customer-id').value); };
            var setOrderId = function() { ravelin.setOrderId(document.getElementById('order-id').value); };

            var trackFingerprint = function() { ravelin.trackFingerprint(); };
            var track = function() { ravelin.track('RANDOM', { rand: ravelin.uuid() }); };
            var trackPage = function() { ravelin.trackPage(); };
            var trackLogin = function() { ravelin.trackLogin(); };
            var trackLogout = function() { ravelin.trackLogout(); };

            document.getElementById('setRSAKey').onclick = setRSAKey;
            document.getElementById('setPublicAPIKey').onclick = setPublicAPIKey;
            document.getElementById('setCustomerId').onclick = setCustomerId;
            document.getElementById('setTempCustomerId').onclick = setTempCustomerId;
            document.getElementById('setOrderId').onclick = setOrderId;

            document.getElementById('trackFingerprint').onclick = trackFingerprint;
            document.getElementById('track').onclick = track;
            document.getElementById('trackPage').onclick = trackPage;
            document.getElementById('trackLogin').onclick = trackLogin;
            document.getElementById('trackLogout').onclick = trackLogout;

            setPublicAPIKey();
            setRSAKey();
        });
    </script>
</body>
</html>

